---
title: "Classification"
layout: "default"
modified:
---

## Methodology

We adhered to the plan described in the Interim report in part "4. Proposed solution". We used program Weka with algorithms J48, Naive Bayes and 3-NN.

## Classification

To create the learning dataset we randomly choose 500 video frames, applyed the image processing scripts we prepared earlier to it and this resulted in creating 2000 segments with individual digits. These segments were manually classified and we prepared the ARFF file. Due to the preparation process, some classes were disproportionately frequent in the testing dataset. For example, 50 % of the instances were the numeral "1". The other numarals were represented in more or less equal numbers.

To validate the results of the learning we used the Cross validation method with 10 folds.

Using only the attributes described in the Interim report (borders and pixel values) the classification algorithms often consfused numerals 1 and 8, sometimes also 1 and 0. This was solved by adding the attribute of the ratio of width and hight of the fragment. The large influence which this attribute has can be seen in the classification tree generated by the J48 algorithm. In the top part of the tree, there is a branching:

    woverh <= 0.333333: 1 (1000.0)
    |   woverh > 0.333333

Additional improvement in accuracy was achieved by adding the attribute of the procentual fraction of black pixels in a segment.

## Accuracy

    Algorithm:  Time to build model: Accuracy:
    Naive Bayes 0,38 s               99,5 %
    J48         1.11 s               99,3 %
    3NN         /                    99.5 %

The corresponding logs from the Weka tool follow.

## Naive Bayes
    Time taken to build model: 0.38 seconds

    === Stratified cross-validation ===
    === Summary ===

    Correctly Classified Instances        1990               99.5    %
    Incorrectly Classified Instances        10                0.5    %
    Kappa statistic                          0.9929
    Mean absolute error                      0.001 
    Root mean squared error                  0.0316
    Relative absolute error                  0.7045 %
    Root relative squared error             11.8786 %
    Total Number of Instances             2000     

    === Detailed Accuracy By Class ===

    	  TP Rate   FP Rate   Precision   Recall  F-Measure   ROC Area  Class
		    0.989     0.001      0.989     0.989     0.989      0.994    0
		    0.999     0.001      0.999     0.999     0.999      0.999    1
		    1         0          1         1         1          1        2
		    1         0          1         1         1          1        3
		    1         0.001      0.982     1         0.991      1        4
		    0.967     0.001      0.983     0.967     0.975      0.991    5
		    0.979     0.001      0.979     0.979     0.979      1        6
		    0.991     0.001      0.991     0.991     0.991      0.997    7
		    0.994     0.001      0.994     0.994     0.994      1        8
		    0.971     0.001      0.971     0.971     0.971      1        9
    Weighted Avg.    0.995     0.001      0.995     0.995     0.995      0.999

    === Confusion Matrix ===

      a   b   c   d   e   f   g   h   i   j   <-- classified as
      87   1   0   0   0   0   0   0   0   0 |   a = 0
      0 999   0   0   0   0   0   0   1   0 |   b = 1
      0   0 260   0   0   0   0   0   0   0 |   c = 2
      0   0   0  35   0   0   0   0   0   0 |   d = 3
      0   0   0   0  55   0   0   0   0   0 |   e = 4
      0   0   0   0   1  58   1   0   0   0 |   f = 5
      0   0   0   0   0   1  47   0   0   0 |   g = 6
      1   0   0   0   0   0   0 213   0   1 |   h = 7
      0   0   0   0   0   0   0   0 168   1 |   i = 8
      0   0   0   0   0   0   0   2   0  68 |   j = 9

## J48
    Time taken to build model: 1.11 seconds

    === Stratified cross-validation ===
    === Summary ===

    Correctly Classified Instances        1986               99.3    %
    Incorrectly Classified Instances        14                0.7    %
    Kappa statistic                          0.9901
    Mean absolute error                      0.0017
    Root mean squared error                  0.0375
    Relative absolute error                  1.185  %
    Root relative squared error             14.0753 %
    Total Number of Instances             2000     

    === Detailed Accuracy By Class ===

		  TP Rate   FP Rate   Precision   Recall  F-Measure   ROC Area  Class
		    0.989     0.001      0.989     0.989     0.989      0.994    0
		    0.999     0.002      0.998     0.999     0.999      0.999    1
		    0.996     0          1         0.996     0.998      0.998    2
		    1         0.002      0.921     1         0.959      0.999    3
		    0.982     0.001      0.982     0.982     0.982      0.99     4
		    0.967     0.001      0.967     0.967     0.967      0.982    5
		    0.979     0.001      0.979     0.979     0.979      0.989    6
		    0.995     0.001      0.991     0.995     0.993      0.997    7
		    0.982     0          1         0.982     0.991      0.991    8
		    0.957     0.001      0.971     0.957     0.964      0.978    9
    Weighted Avg.    0.993     0.001      0.993     0.993     0.993      0.996

    === Confusion Matrix ===

      a   b   c   d   e   f   g   h   i   j   <-- classified as
      87   0   0   0   0   0   0   1   0   0 |   a = 0
      0 999   0   1   0   0   0   0   0   0 |   b = 1
      0   0 259   1   0   0   0   0   0   0 |   c = 2
      0   0   0  35   0   0   0   0   0   0 |   d = 3
      0   0   0   0  54   0   0   0   0   1 |   e = 4
      0   0   0   0   1  58   1   0   0   0 |   f = 5
      0   0   0   0   0   1  47   0   0   0 |   g = 6
      1   0   0   0   0   0   0 214   0   0 |   h = 7
      0   2   0   0   0   0   0   0 166   1 |   i = 8
      0   0   0   1   0   1   0   1   0  67 |   j = 9

## 3nearest neighbours
    Time taken to build model: 0 seconds

    === Stratified cross-validation ===
    === Summary ===

    Correctly Classified Instances        1990               99.5    %
    Incorrectly Classified Instances        10                0.5    %
    Kappa statistic                          0.9929
    Mean absolute error                      0.0014
    Root mean squared error                  0.0289
    Relative absolute error                  0.9837 %
    Root relative squared error             10.8384 %
    Total Number of Instances             2000     

    === Detailed Accuracy By Class ===

		  TP Rate   FP Rate   Precision   Recall  F-Measure   ROC Area  Class
		    1         0.001      0.989     1         0.994      1        0
		    1         0.001      0.999     1         1          1        1
		    1         0          1         1         1          1        2
		    1         0.001      0.972     1         0.986      1        3
		    1         0.001      0.982     1         0.991      1        4
		    0.967     0.001      0.983     0.967     0.975      0.983    5
		    0.979     0.001      0.979     0.979     0.979      0.989    6
		    0.995     0.002      0.986     0.995     0.991      0.997    7
		    0.988     0          1         0.988     0.994      1        8
		    0.943     0.001      0.985     0.943     0.964      0.986    9
    Weighted Avg.    0.995     0.001      0.995     0.995     0.995      0.998

    === Confusion Matrix ===

      a   b   c   d   e   f   g   h   i   j   <-- classified as
      88   0   0   0   0   0   0   0   0   0 |   a = 0
      0 1000   0   0   0   0   0   0   0   0 |   b = 1
      0   0 260   0   0   0   0   0   0   0 |   c = 2
      0   0   0  35   0   0   0   0   0   0 |   d = 3
      0   0   0   0  55   0   0   0   0   0 |   e = 4
      0   0   0   0   1  58   1   0   0   0 |   f = 5
      0   0   0   0   0   1  47   0   0   0 |   g = 6
      1   0   0   0   0   0   0 214   0   0 |   h = 7
      0   1   0   0   0   0   0   0 167   1 |   i = 8
      0   0   0   1   0   0   0   3   0  66 |   j = 9